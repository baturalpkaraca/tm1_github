SKIPCHECK;

[  ] = IF(ELPAR('Version', !Version, 1) @= 'Aktif', CONTINUE, STET);

[ 'Capex' ] =  N: 
	IF(SCAN('Forecast', !Version) <> 0 & DB('V_P', !Version, !Period, 'Actual - Plan' ) @= 'Actual', 
    DB( 'Yatırım Amortisman', 'Toplam Duran Varlık', 'All Cost Centers', !Version, !Period, 'Yatırım' ), CONTINUE);

[ 'Capex' ] =  N: 
    DB( 'Yatırım', 'Departman Toplam', 'Toplam Yatırım', 'Toplam Duran Varlık', 'All Cost Centers', !Version, !Period, 'Yatırım - Final' );

[ 'Purchases' ] =  N: 
	DB('Ticari Borçlar', 'Kanuni', !Version, !Period, 'Alım');

[ 'Total Costs' ] =  N: 
    DB( 'Genel Giderler', 'COST', 'Koçtaş Total', 'Departman Toplam', !Version, !Period, 'Amount Cost' );

[ 'Payroll' ] =  N: 
  DB('Genel Giderler', 'Salary', 'Koçtaş Total', 'Departman Toplam', !Version, !Period, 'Amount Cost') + 
  DB('Genel Giderler', 'Salary (1/3)', 'Koçtaş Total', 'Departman Toplam', !Version, !Period, 'Amount Cost') + 
  DB('Genel Giderler', 'Vacation Fees', 'Koçtaş Total', 'Departman Toplam', !Version, !Period, 'Amount Cost') + 
  DB('Genel Giderler', 'Holiday Fees', 'Koçtaş Total', 'Departman Toplam', !Version, !Period, 'Amount Cost') + 
  DB('Genel Giderler', 'Heating Aids', 'Koçtaş Total', 'Departman Toplam', !Version, !Period, 'Amount Cost') + 
  DB('Genel Giderler', 'Education Aids', 'Koçtaş Total', 'Departman Toplam', !Version, !Period, 'Amount Cost') + 
  DB('Genel Giderler', 'Children Aids', 'Koçtaş Total', 'Departman Toplam', !Version, !Period, 'Amount Cost') + 
  DB('Genel Giderler', 'SSK (Social Insurance)', 'Koçtaş Total', 'Departman Toplam', !Version, !Period, 'Amount Cost') + 
  DB('Genel Giderler', 'Funds (Koç Holding Retirement Fund)', 'Koçtaş Total', 'Departman Toplam', !Version, !Period, 'Amount Cost') + 
  DB('Genel Giderler', 'Unemployment Insurance', 'Koçtaş Total', 'Departman Toplam', !Version, !Period, 'Amount Cost') + 
  DB('Genel Giderler', 'Cash İndemity', 'Koçtaş Total', 'Departman Toplam', !Version, !Period, 'Amount Cost') + 
  DB('Genel Giderler', 'Board Members Fees', 'Koçtaş Total', 'Departman Toplam', !Version, !Period, 'Amount Cost');

[ 'Bonus' ] =  N: 
	DB('Genel Giderler', 'Bonus', 'Koçtaş Total', 'Departman Toplam', !Version, !Period, 'Amount Cost');

[ 'Other' ] =  N: 
  DB('Genel Giderler', 'Termination & Notification Payment', 'Koçtaş Total', 'Departman Toplam', !Version, !Period, 'Amount Cost') + 
  DB('Genel Giderler', 'Children, Wedding & Military Service Expenses', 'Koçtaş Total', 'Departman Toplam', !Version, !Period, 'Amount Cost') + 
  DB('Genel Giderler', 'Medical Aids for Personnel', 'Koçtaş Total', 'Departman Toplam', !Version, !Period, 'Amount Cost');

[ 'Depreciation' ] =  N: 
	DB('Genel Giderler', 'Depreciation', 'Koçtaş Total', 'Departman Toplam', !Version, !Period, 'Amount Cost');

[ 'Tax, Duty and Fees' ] =  N: 
	DB('Genel Giderler', 'Tax, Duty and Fees', 'Koçtaş Total', 'Departman Toplam', !Version, !Period, 'Amount Cost');

[ 'Taxes' ] =  N: 
  DB('Genel Giderler', 'Estate Taxes', 'Koçtaş Total', 'Departman Toplam', !Version, !Period, 'Amount Cost') + 
  DB('Genel Giderler', 'Stamp Taxes', 'Koçtaş Total', 'Departman Toplam', !Version, !Period, 'Amount Cost') + 
  DB('Genel Giderler', 'Vehicles Taxes', 'Koçtaş Total', 'Departman Toplam', !Version, !Period, 'Amount Cost') + 
  DB('Genel Giderler', 'Other Taxes', 'Koçtaş Total', 'Departman Toplam', !Version, !Period, 'Amount Cost');

[ 'Finance' ] =  N: 
  DB('Genel Giderler', 'Bank Interest Expenses', 'Koçtaş Total', 'Departman Toplam', !Version, !Period, 'Amount Cost') + 
  DB('Genel Giderler', 'Given Exchange Rate Differences', 'Koçtaş Total', 'Departman Toplam', !Version, !Period, 'Amount Cost') + 
  DB('Genel Giderler', 'Over Due Interest Expenses', 'Koçtaş Total', 'Departman Toplam', !Version, !Period, 'Amount Cost') + 
  DB('Genel Giderler', 'Other Financial Expenses', 'Koçtaş Total', 'Departman Toplam', !Version, !Period, 'Amount Cost') + 
  DB('Genel Giderler', 'Credit Card Commissions', 'Koçtaş Total', 'Departman Toplam', !Version, !Period, 'Amount Cost');

[ 'KDVli gider toplamı' ] =  N: 
	[ 'Total Costs' ] - [ 'Selected Costs' ];

[ '191' ] =  N: 
	([ 'Capex' ] + [ 'Purchases' ] + [ 'KDVli gider toplamı' ]) * 0.20;

[ 'Sales' ] =  N: 
    DB( 'PL', 'NET SALES', 'Total Source', 'Koçtaş Total', !Version, !Period, 'Amount' );

[ 'Iraq sales' ] =  N: 
	DB( 'PL', 'NET SALES', 'Total Source', '1345002', !Version, !Period, 'Amount' );

[ 'Sales (exc. Iraq)' ] =  N: 
	[ 'Sales' ] - [ 'Iraq Sales' ];

[ '391' ] =  N: 
	[ 'Sales (exc. Iraq)' ] * 0.20;

[ 'Net' ] =  N: 
	[ '191' ] - [ '391' ];

[ 'Net (191)' ] =  N: IF( ['Net'] > 0 , ['Net'], CONTINUE );

[ 'Net (391)' ] =  N: IF( ['Net'] < 0 , ['Net'], CONTINUE );

FEEDERS;

[ 'Aktif', 'Total Costs' ] => [ 'Selected Costs' ], [ 'KDVli gider toplamı' ];

[ 'Aktif', { 'Capex', 'Purchases', 'KDVli gider toplamı' } ] => [ '191' ];

[ 'Aktif', 'Sales' ] => [ 'Iraq sales' ], [ 'Sales (exc. Iraq)' ];

[ 'Aktif', 'Sales (exc. Iraq)' ] => [ '391' ];

[ 'Aktif', { '191', '391' } ] => [ 'Net' ], [ 'Net (191)' ], [ 'Net (391)' ];

[ 'Aktif', 'Net (191)' ] => DB( 'Mali Tablo', '191', 'KDV', !Version, !Period, 'Movement' );
[ 'Aktif', 'Net (391)' ] => DB( 'Mali Tablo', '391', 'KDV', !Version, !Period, 'Movement' );
